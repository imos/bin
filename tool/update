#!/bin/bash
# Update scripts inside the bin directory.
#
# This script should not use imosh so that we can revert imosh even if imosh is
# buggy.

IMOS_GIT='https://raw.githubusercontent.com/imos'
IMOS_GIST='https://gist.githubusercontent.com/imos'
TARGETS=(
  "imosh@${IMOS_GIT}/imosh/master/imosh"
)

cd "$(dirname "${BASH_SOURCE}")/.."

update() {
  if [ "$#" -eq 2 ]; then
    local command="$1"
    local url="$2"
    curl "${url}" > "${command}"
    chmod +x "${command}"
  else
    echo 'update requires at least two arguments.' >&2
    exit 1
  fi
}

main() {
  local target=''
  init_readme
  for target in "${TARGETS[@]}"; do
    IFS='@' eval "local args=(\${target})"
    update "${args[@]}"
  done
}

main
